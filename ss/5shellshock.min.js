/*VERSION:0.39.6*/

window._utils = {};
window._utils.requirelib = async function(url, global){
  return new Promise(async function(resolve){
    async function getCode(){
      var xmlHttp = new XMLHttpRequest();
      xmlHttp.open( "GET", url, false );
      xmlHttp.send( null );
      return xmlHttp.responseText;
    }
    let code = await getCode();

    if (global){
      code += 'window["' + global + '"] = ' + global + ';';
    }
    let evaluateCode = new Function(code);
    evaluateCode();
    resolve('done');
  });
};

window._utils.requirelib('https://unpkg.com/guify@0.12.0/lib/guify.min.js').then(() => { 
  window.jeff.loadGui();
});

window.jeff = {
  loadGui: ()=>{},
  modMenu: { 
    credit: {},
    skins: {
      unlockAll: ()=>{},
      onGotSkins: ()=>{},
      container: {
        label: {}
      }
    },
  },
  gui: {},
  items: [],
  itemsById: []
};

window.jeff.loadGui = function(){
  
  window.jeff.gui = new guify({
    title: 'JeffWare 0.0.0',
    theme: 'light',
    align: 'right',
    barMode: 'none',
    opacity: 0.95,
    open: true,
  });
  
  jeff.modMenu.skins.container.label = jeff.gui.Register({
    type: 'folder',
    label: 'Skins',
    open: false
  });

  jeff.modMenu.skins.container.resetSettings = jeff.gui.Register({
    type: 'button',
    label: 'Unlock All',
    folder: 'Skins',
    action: function(){
      window.jeff.modMenu.skins.unlockAll();
    }
  });
  
  jeff.modMenu.credit = jeff.gui.Register({
    type: 'text',
    label: 'Credits'
  });
  
  window.jeff.modMenu.credit.container.innerHTML = `<p style="color:black;font-size: medium;margin-bottom: 0px;padding-left: 15px;">Hey</p>`

  let titleTextElm = window.jeff.gui.panel.panel.childNodes[0];
  titleTextElm.style.color = "black";
  titleTextElm.style.fontWeight = "bold";
}
                            
let codeVersion = "0.39.7";
let gameVersion = window.version;
if (codeVersion != gameVersion){
  alert(`JeffWare Code Version does not match ShellShockers current version

JeffWare Version: ${codeVersion}
Game Version: ${gameVersion}`);
}

window.jeff.modMenu.skins.onGotSkins = function(){
  window.jeff.modMenu.skins.unlockAll = function(){
    for (_i in window.jeff.items){
      if (_i == "shallowClone"){continue;}
      let item = window.jeff.items[_i];
      extern.account.addToInventory(item);
    }
  };
  window.jeff.itemsById = [];
  for (_i in window.jeff.items){
    if (_i == "shallowClone"){continue;}
    let item = window.jeff.items[_i];
    window.jeff.itemsById[item.id] = item;
  }
}
